{% extends "basic.html" %}
{% block title %}Shopping Cart - ShopEase{% endblock title %}
{% block body %}

<div style="background: linear-gradient(135deg, #f8f9fe 0%, #eef2ff 100%); padding: 40px 0;">
	<div class="container">
		<h1
			style="font-size: 2.5rem; font-weight: 700; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px;">
			Shopping Cart
		</h1>
		<p style="color: #64748b; font-size: 1.1rem;">Review your items before checkout</p>
	</div>
</div>

<div style="background: #f8f9fe; padding: 60px 0; min-height: 70vh;">
	<div class="container">
		<!-- Empty Cart State -->
		<div id="emptyCart" style="display: none;">
			<div class="text-center py-5">
				<div
					style="background: white; border-radius: 20px; padding: 60px 40px; box-shadow: 0 10px 30px rgba(0,0,0,0.08);">
					<svg width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="#cbd5e0" stroke-width="2"
						class="mx-auto mb-4">
						<circle cx="9" cy="21" r="1"></circle>
						<circle cx="20" cy="21" r="1"></circle>
						<path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
					</svg>
					<h3 style="font-size: 1.8rem; font-weight: 700; color: #1a202c; margin-bottom: 15px;">
						Your Cart is Empty
					</h3>
					<p style="color: #718096; font-size: 1.1rem; margin-bottom: 30px;">
						Add some awesome products to get started!
					</p>
					<a href="/shop/" class="btn"
						style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 14px 35px; border-radius: 12px; font-weight: 600; text-decoration: none;">
						Start Shopping
					</a>
				</div>
			</div>
		</div>

		<!-- Cart Items -->
		<div class="row" id="cartContent">
			<div class="col-lg-8 mb-4">
				<div class="card border-0 shadow-sm" style="border-radius: 20px; overflow: hidden;">
					<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px;">
						<h3 style="color: white; font-size: 1.3rem; font-weight: 700; margin: 0;">
							Cart Items (<span id="itemCount">0</span>)
						</h3>
					</div>
					<div style="padding: 30px;" id="items">
						<!-- Cart items will be populated here -->
					</div>
				</div>
			</div>

			<div class="col-lg-4">
				<div class="card border-0 shadow-sm"
					style="border-radius: 20px; overflow: hidden; position: sticky; top: 20px;">
					<div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 25px;">
						<h3 style="color: white; font-size: 1.3rem; font-weight: 700; margin: 0;">
							Order Summary
						</h3>
					</div>
					<div style="padding: 30px;">
						<div
							style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 2px solid #e2e8f0;">
							<span style="color: #64748b; font-size: 1.1rem; font-weight: 500;">Subtotal</span>
							<span style="color: #1a202c; font-size: 1.3rem; font-weight: 700;" id="subtotal">₹0</span>
						</div>
						<div
							style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 2px solid #e2e8f0;">
							<span style="color: #64748b; font-size: 1.1rem; font-weight: 500;">Shipping</span>
							<span style="color: #10b981; font-size: 1.1rem; font-weight: 600;">FREE</span>
						</div>
						<div
							style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; padding: 20px; background: #f8f9fe; border-radius: 12px;">
							<span style="color: #1a202c; font-size: 1.2rem; font-weight: 700;">Total</span>
							<span style="color: #1a202c; font-size: 1.8rem; font-weight: 700;" id="totalPrice">₹0</span>
						</div>
						<a href="/checkout/" class="btn btn-block" id="checkoutBtn"
							style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 16px; border-radius: 12px; font-weight: 600; font-size: 1.1rem; text-decoration: none; display: block; text-align: center; margin-bottom: 15px;">
							Proceed to Checkout
						</a>
						<a href="/shop/" class="btn btn-outline-secondary btn-block"
							style="border: 2px solid #e2e8f0; background: white; color: #64748b; padding: 14px; border-radius: 12px; font-weight: 600; text-decoration: none; display: block; text-align: center;">
							Continue Shopping
						</a>
						<button class="btn btn-outline-danger btn-block mt-3" onclick="clearCart()"
							style="border: 2px solid #fee; background: #fef2f2; color: #dc2626; padding: 14px; border-radius: 12px; font-weight: 600;">
							Clear Cart
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
	// Get cart from localStorage
	let cart = {};
	if (localStorage.getItem("cart")) {
		cart = JSON.parse(localStorage.getItem("cart"));
	}

	// Check if cart is empty
	if (Object.keys(cart).length === 0) {
		document.getElementById('emptyCart').style.display = 'block';
		document.getElementById('cartContent').style.display = 'none';
	} else {
		document.getElementById('emptyCart').style.display = 'none';
		document.getElementById('cartContent').style.display = 'flex';
		renderCart();
	}

	function renderCart() {
		let itemsContainer = document.getElementById('items');
		itemsContainer.innerHTML = '';
		let totalPrice = 0;
		let itemCount = 0;

		for (let item in cart) {
			let name = cart[item][1];
			let qty = cart[item][0];
			let price = cart[item][2];
			let itemPrice = Number(price.split(' ')[1]);
			totalPrice += itemPrice;
			itemCount++;

			let cartItem = `
        <div class="cart-item mb-3" style="background: #f8f9fe; border-radius: 15px; padding: 20px; transition: all 0.3s ease;">
          <div class="row align-items-center">
            <div class="col-md-2 col-3">
              <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #f8f9fe 0%, #e9ecef 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="2">
                  <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                  <line x1="8" y1="21" x2="16" y2="21"></line>
                  <line x1="12" y1="17" x2="12" y2="21"></line>
                </svg>
              </div>
            </div>
            <div class="col-md-5 col-9">
              <h5 style="font-size: 1.2rem; font-weight: 700; color: #1a202c; margin-bottom: 5px;">${name}</h5>
              <p style="color: #64748b; font-size: 0.9rem; margin: 0;">Quantity: ${qty}</p>
            </div>
            <div class="col-md-3 col-6 text-center">
              <span style="font-size: 1.5rem; font-weight: 700; color: #1a202c;">${price}</span>
            </div>
            <div class="col-md-2 col-6 text-right">
              <button onclick="removeItem('${item}')" class="btn btn-sm" 
                style="background: #fee2e2; color: #dc2626; border: none; padding: 10px 15px; border-radius: 10px; font-weight: 600;">
                Remove
              </button>
            </div>
          </div>
        </div>
      `;
			itemsContainer.innerHTML += cartItem;
		}

		document.getElementById('itemCount').textContent = itemCount;
		document.getElementById('subtotal').textContent = `₹${totalPrice}`;
		document.getElementById('totalPrice').textContent = `₹${totalPrice}`;
	}

	function removeItem(itemId) {
		if (confirm('Are you sure you want to remove this item?')) {
			delete cart[itemId];
			localStorage.setItem("cart", JSON.stringify(cart));

			if (Object.keys(cart).length === 0) {
				document.getElementById('emptyCart').style.display = 'block';
				document.getElementById('cartContent').style.display = 'none';
			} else {
				renderCart();
			}

			// Update cart counter in navbar
			updateCartCounter();
		}
	}

	function clearCart() {
		if (confirm('Are you sure you want to clear your entire cart?')) {
			localStorage.removeItem("cart");
			cart = {};
			document.getElementById('emptyCart').style.display = 'block';
			document.getElementById('cartContent').style.display = 'none';
			updateCartCounter();
		}
	}

	function updateCartCounter() {
		// Update cart counter in basic.html navigation
		let cartCounter = document.getElementById('cart');
		if (cartCounter) {
			cartCounter.textContent = Object.keys(cart).length;
		}
	}
</script>

<style>
	.cart-item:hover {
		background: #eef2ff !important;
		transform: translateX(5px);
	}

	.btn:hover {
		transform: translateY(-2px);
		box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15) !important;
	}
</style>

{% endblock body %}